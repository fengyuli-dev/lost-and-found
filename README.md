# Lost & Found at Cornell
A lost & found iOS app built during Cornell Appdev's Hack Challenge FA21.
## The Team
- Soleil Su: Designer
- [Haoxuan Zou](https://github.com/PORRIDGE-ZOU): iOS frontend developer
- [Vivian Fan](https://github.com/Vivian0913): iOS frontend developer
- [Li Fengyu](https://github.com/fengyuli2002): backend developer
## Summary
To be finished.
## The Database
This project contains a SQL database with three tables: user, lost, and found. Table "user" has one-to-many relationships with "lost" and "found".
## API Documentation
### Failures
Failures responses are ALL in this form: 
```
{
    "error": true
}
```
They may have different HTTP status codes, here are their general meanings:
- 500 indicates internal server error and should be reported to the backend developer.
- 401 indicates unauthrozied access due to an invalid authentication token.
- 404 indicates that the target is not found.
- 400 means the request format is compromised.
  
For post methods, the field time should be in the format of strings.
### Authentication for User-specific Endpoints
These endpoint involve operations on a user's data:
1. Posting a lost or a found item
2. Get all items lost/founded by a user
3. Delete an item lost/founded by a user
4. `POST /api/session/`

Calls to these endpoints must have an entry in their request header as such:
```
{
    "Authorization": <SESSION/UPDATE TOKEN>
}
```

Session tokens and update tokens are generated when a user is registered. Session tokens are valid for 1 hour, after which a new session token must be generated by accessing the `POST /api/session/` endpoint using the current update token.
### `POST /api/register/`
Register a new empty user.

Request:
```
{
    "email": <USER EMAIL, NOT NULL>,
    "password": <USER PASSWORD, NOT NULL>
}
```
Response:
```
<HTTP STATUS CODE 201>
{
    "session_token": <SESSION TOKEN>,
    "session_expiration": <EXPIRATION TIME, AS STRING>,
    "update_token": <UPDATE TOKEN>,
    "detail": {
        "id": <USER ID>,
        "email": <USER EMAIL>,
        "lost": [ <SERIALIZED LOST ITEMS>, ... ],
        "found": [ <SERIALIZED FOUND ITEMS>, ... ]
    }
}
```
### `POST /api/login/`
Login a user that has been previously registered.
Request and response are the same as `POST /api/register/` excepts that a successfully login returns a status code of 200.
### `POST /api/session/`
Update a user's session.

Note that for this method, the `update_token` must be supplied as the header in the API call.

Response:
```
<HTTP STATUS CODE 200>
{
    "session_token": <NEW SESSION TOKEN>,
    "session_expiration": <NEW EXPIRATION TIME, AS STRING>,
    "update_token": <NEW UPDATE TOKEN>,
}
```
### `GET /api/lost/`
Retrieve all lost items.

Response:
```
<HTTP STATUS CODE 200>
{
    "lost": [ <SERIALIZED LOST ITEMS>, ... ]
}
```
### `GET /api/found/`
Retrieve all found items.

Response:
```
<HTTP STATUS CODE 200>
{
    "found": [ <SERIALIZED FOUND ITEMS>, ... ]
}
```
### `GET /api/lost/{lost_id}/`
Retrive one lost item that matches the given id.

Response if there exists such item:
```
<HTTP STATUS CODE 200>
{
    "id": <ID>,
    "name": <NAME OF THE LOST ITEM, NOT NULL>,
    "description": <DESCRPTION OF THE LOST ITEM, COULD BE NULL>,
    "time": <TIME WHEN THE ITEM WAS LOST, COULD BE NULL>,
    "location": <WHERE THE ITEM WAS LOST, COULD BE NULL>,
    "user": <SERIALIZED USER, NOT NULL>
}
```
### `GET /api/found/{found_id}/`
Retrive one found item that matches the given id.

Response if there exists such item:
```
<HTTP STATUS CODE 200>
{
    "id": <ID>,
    "name": <NAME OF THE FOUND ITEM, NOT NULL>,
    "description": <DESCRPTION OF THE FOUND ITEM, COULD BE NULL>,
    "time": <TIME WHEN THE ITEM WAS FOUND, COULD BE NULL>,
    "location": <WHERE THE ITEM WAS FOUND, COULD BE NULL>,
    "user": <SERIALIZED USER, NOT NULL>
}
```
### `GET /api/lost/user/`
Retrive all lost items that belong to a user with the given id.

Response if there exists such item:
```
<HTTP STATUS CODE 200>
{
    "lost": [ <SERIALIZED LOST ITEMS>, ... ]
}
```
### `GET /api/found/user/`
Retrive all items that are found by a user with the given id.

Response if there exists such item:
```
<HTTP STATUS CODE 200>
{
    "found": [ <SERIALIZED FOUND ITEMS>, ... ]
}
```
### `POST /api/lost/`
Let a user post that a item is lost.

Request:
```
{
    "name": <NAME, NOT NULL>,
    "description": <DISCRIPTION>,
    "time": <TIME>,
    "location": <LOCATION>
}
```
Response:  
Same as `GET /api/lost/{lost_id}/` except that a success post returns HTTP status code 201.
### `POST /api/found/`
Let a user post that a item is found.

Request:
```
{
    "name": <NAME, NOT NULL>,
    "description": <DISCRIPTION>,
    "time": <TIME>,
    "location": <LOCATION>
}
```
Response:  
Same as `GET /api/found/{found_id}/` except that a success post returns HTTP status code 201.
### `DELETE /api/lost/{lost_id}/`
Delete a specific lost item. This operation will be automatically rejected if the item is not lost by the user identified using the session token supplied in the header of this API call. HTTP status code 401 will be thrown in this case.

Response:  
Same as `GET /api/lost/{lost_id}/` 
### `DELETE /api/found/{found_id}/`
Delete a specific found item. This operation will be automatically rejected if the item is not founded by the user identified using the session token supplied in the header of this API call. HTTP status code 401 will be thrown in this case.

Response:  
Same as `GET /api/found/{found_id}/`
